<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Wedding Invitation - Suriansyah & Sonia Agustina Oemar</title>

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400;600;700&family=Playfair+Display:wght@400;600;700&family=Amiri:wght@400;700&display=swap" rel="stylesheet">

    <!-- Favicon (inline SVG to avoid extra request) -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>💍</text></svg>">

    <!-- External stylesheet -->
    <link rel="stylesheet" href="style.css">

    <!-- Lottie Player & GSAP for Animations -->
    <script src="https://unpkg.com/@lottiefiles/lottie-player@latest/dist/lottie-player.js" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/ScrollTrigger.min.js" defer></script>
</head>
<body>
    <!-- Audio Background Music -->
    <audio id="backgroundMusic" loop>
        <source src="https://github.com/ss2811/weddinginvitation/raw/refs/heads/main/backgroundmusic.mp3" type="audio/mpeg">
    </audio>

    <!-- Halaman Pembuka (Landing Page) -->
    <div class="landing-page" id="landingPage" role="region" aria-label="Halaman pembuka undangan">
        <div class="lottie-overlay" aria-hidden="true">
            <!-- Opening Lottie (valid LottieFiles CDN) -->
            <lottie-player
                src="https://assets2.lottiefiles.com/packages/lf20_GbabwrUY2k.json"
                background="transparent"
                speed="1"
                loop
                autoplay
                style="width:100%;height:100%;">
            </lottie-player>
        </div>

        <div class="session-content">
            <div class="invitation-title">
                <h1 class="shimmer-text animated-element">Wedding Invitation</h1>
                <h2 class="shimmer-text couple-names animated-element">of</h2>
                <h2 class="shimmer-text couple-names animated-element">Suriansyah & Sonia</h2>
                <p class="wedding-date shimmer-text animated-element">24 September 2025</p>
            </div>
            <button class="btn btn--primary open-invitation animated-element" id="openInvitationBtn" aria-label="Buka undangan">
                Buka Undangan
            </button>
        </div>
    </div>

    <!-- Konten Utama Undangan -->
    <main class="main-content" id="mainContent" aria-live="polite">
        
        <section class="content-section" id="countdown">
            <div class="lottie-bg" aria-hidden="true">
                <!-- Countdown particles (LottieFiles CDN) -->
                <lottie-player
                    src="https://assets7.lottiefiles.com/packages/lf20_Yc2PU8DdfX.json"
                    background="transparent"
                    speed="0.5"
                    loop
                    autoplay
                    style="width:100%;height:100%;">
                </lottie-player>
            </div>
            <div class="session-content">
                <h2 class="animated-element">Menuju Hari Bahagia</h2>
                <div class="countdown-container animated-element" role="timer" aria-label="Countdown sampai hari pernikahan">
                    <div class="countdown-item"><span id="days">00</span><label>Hari</label></div>
                    <div class="countdown-item"><span id="hours">00</span><label>Jam</label></div>
                    <div class="countdown-item"><span id="minutes">00</span><label>Menit</label></div>
                    <div class="countdown-item"><span id="seconds">00</span><label>Detik</label></div>
                </div>
                <div class="action-buttons animated-element">
                    <button class="btn btn--primary" id="saveDateBtn">Save The Date</button>
                    <button class="btn btn--outline" id="shareBtn">Bagikan Undangan</button>
                </div>
            </div>
        </section>

        <section class="content-section" id="bismillah">
            <div class="lottie-bg" aria-hidden="true">
                <!-- Bismillah / spiritual Lottie -->
                <lottie-player
                    src="https://assets2.lottiefiles.com/packages/lf20_i9mxcD.json"
                    background="transparent"
                    speed="1"
                    loop
                    autoplay
                    style="width:100%;height:100%;">
                </lottie-player>
            </div>
            <div class="session-content">
                <div class="bismillah-section">
                    <h2 class="arabic-text shimmer-text animated-element">بِسْمِ ٱللَّهِ ٱلرَّحْمَٰنِ ٱلرَّحِيمِ</h2>
                    <p class="translation animated-element">Dengan menyebut nama Allah Yang Maha Pengasih lagi Maha Penyayang</p>
                    <blockquote class="quran-verse animated-element">
                        "Dan di antara tanda-tanda (kebesaran)-Nya ialah Dia menciptakan pasangan-pasangan untukmu dari jenismu sendiri, agar kamu cenderung dan merasa tenteram kepadanya, dan Dia menjadikan di antaramu rasa kasih dan sayang. Sungguh, pada yang demikian itu benar-benar terdapat tanda-tanda (kebesaran Allah) bagi kaum yang berpikir."
                        <cite>QS. Ar-Rum: 21</cite>
                    </blockquote>
                </div>
            </div>
        </section>

        <section class="content-section" id="couple">
            <div class="lottie-bg" aria-hidden="true">
                <!-- Hearts / romantic Lottie -->
                <lottie-player
                    src="https://assets10.lottiefiles.com/packages/lf20_K0864uP6eC.json"
                    background="transparent"
                    speed="1"
                    loop
                    autoplay
                    style="width:100%;height:100%;">
                </lottie-player>
            </div>
            <div class="session-content">
                <p class="invitation-text animated-element">
                    Dengan memohon rahmat dan ridho Allah SWT, kami mengundang Bapak/Ibu/Saudara/i untuk menghadiri pernikahan kami:
                </p>
                <div class="couple-photos animated-element">
                    <div class="photo-container">
                        <div class="photo-frame"><img src="https://raw.githubusercontent.com/ss2811/weddinginvitation/refs/heads/main/groom.jpeg" alt="Suriansyah" class="couple-photo"></div>
                        <h3 class="shimmer-text">Suriansyah, S. Kep., Ners</h3>
                    </div>
                    <div class="couple-divider"><span class="shimmer-text">&</span></div>
                    <div class="photo-container">
                        <div class="photo-frame"><img src="https://raw.githubusercontent.com/ss2811/weddinginvitation/refs/heads/main/bride.jpeg" alt="Sonia Agustina Oemar" class="couple-photo"></div>
                        <h3 class="shimmer-text">Sonia Agustina Oemar, S.Farm</h3>
                    </div>
                </div>
            </div>
        </section>

        <section class="content-section" id="details">
            <div class="session-content">
                <h2 class="shimmer-text animated-element">Detail Acara</h2>
                <div class="event-details">
                    <div class="event-item animated-element">
                        <h3>Akad Nikah</h3>
                        <div class="event-info"><p><strong>Waktu:</strong> 07:00 - 08:00 WITA</p><p><strong>Tempat:</strong> Masjid Jabal Rahmah Mandin</p></div>
                    </div>
                    <div class="event-item animated-element">
                        <h3>Resepsi</h3>
                        <div class="event-info"><p><strong>Waktu:</strong> 08:00 WITA - Selesai</p><p><strong>Tempat:</strong> Rumah Mempelai Wanita<br>Samping Masjid Jabal Rahmah Mandin</p></div>
                    </div>
                </div>
                <button class="btn btn--primary animated-element" id="openMapsBtn">📍 Buka Peta Lokasi</button>
            </div>
        </section>

        <section class="content-section" id="rsvp">
            <div class="session-content">
                <h2 class="animated-element">RSVP & Ucapan</h2>
                <div class="rsvp-form animated-element">
                    <div class="form-group"><label class="form-label" for="guestName">Nama Lengkap</label><input type="text" class="form-control" id="guestName" placeholder="Masukkan nama Anda"></div>
                    <div class="form-group"><label class="form-label" for="guestMessage">Ucapan & Doa</label><textarea class="form-control" id="guestMessage" rows="4" placeholder="Tulis ucapan dan doa untuk kami"></textarea></div>
                    <div class="form-group"><label class="form-label" for="attendance">Konfirmasi Kehadiran</label><select class="form-control" id="attendance"><option value="">Pilih konfirmasi...</option><option value="hadir">Insya Allah, Akan Hadir</option><option value="tidak_hadir">Maaf, Tidak Dapat Hadir</option></select></div>
                    <div class="action-buttons"><button type="button" id="submitRsvpBtn" class="btn btn--primary">Kirim Ucapan</button></div>
                </div>
            </div>
        </section>

        <section class="content-section" id="gift">
            <div class="session-content">
                <h2 class="animated-element">Kado Cashless</h2>
                <p class="gift-text animated-element">Doa restu dari Bapak/Ibu/Saudara/i merupakan karunia yang sangat berarti bagi kami. Dan jika ingin memberikan kado, dapat melalui rekening berikut:</p>
                <div class="bank-accounts">
                    <div class="bank-item animated-element"><h3 class="shimmer-text">Bank Mandiri</h3><div class="account-info"><span class="account-number">1410001081983</span><button type="button" class="copy-btn" data-account="1410001081983">📋 Salin</button></div><p class="account-name">a.n. Sonia Agustina Oemar</p></div>
                    <div class="bank-item animated-element"><h3 class="shimmer-text">Bank BPD Kalsel</h3><div class="account-info"><span class="account-number">3202963349</span><button type="button" class="copy-btn" data-account="3202963349">📋 Salin</button></div><p class="account-name">a.n. Sonia Agustina Oemar</p></div>
                </div>
            </div>
        </section>
        
        <section class="content-section" id="messages">
            <div class="session-content">
                <h2 class="animated-element">Ucapan & Doa</h2>
                <div class="messages-container animated-element" id="messagesContainer"><p id="noMessages" class="no-messages">Belum ada ucapan dari tamu</p></div>
            </div>
        </section>

        <section class="content-section" id="thankyou">
            <div class="lottie-bg" aria-hidden="true">
                <!-- Confetti / thank you Lottie -->
                <lottie-player
                    src="https://assets2.lottiefiles.com/packages/lf20_touohxv0.json"
                    background="transparent"
                    speed="1"
                    loop
                    autoplay
                    style="width:100%;height:100%;">
                </lottie-player>
            </div>
            <div class="session-content">
                <h2 class="shimmer-text animated-element">Terima Kasih</h2>
                <div class="thank-you-content animated-element">
                    <p>Merupakan suatu kehormatan dan kebahagiaan bagi kami sekeluarga apabila Bapak/Ibu/Saudara/i berkenan hadir untuk memberikan doa restu kepada kedua mempelai.</p>
                    <p>Atas kehadiran dan doa restu, kami mengucapkan terima kasih.</p>
                    <div class="signature"><p><strong>Suriansyah & Sonia</strong></p></div>
                </div>
            </div>
        </section>

        <section class="content-section" id="gallery">
            <div class="session-content">
                <h2 class="animated-element">Galeri</h2>
                <div class="video-container animated-element"><iframe id="weddingVideo" src="https://www.youtube.com/embed/xXRjeURBYAE?si=42mew4CteNsfwwQF&enablejsapi=1" title="Wedding Video" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe></div>
            </div>
        </section>
        
    </main>

    <!-- YouTube iframe API (untuk kontrol video) -->
    <script src="https://www.youtube.com/iframe_api" defer></script>

    <!-- Fallback checker: jika Lottie JSON gagal, ganti dengan placeholder image -->
    <script>
    // Cek semua lottie-player; jika src JSON gagal load, ganti dengan fallback (gambar statis)
    async function checkLottiePlayers(timeoutMs = 7000) {
      const players = Array.from(document.querySelectorAll('lottie-player'));
      for (const p of players) {
        const src = p.getAttribute('src') || p.getAttribute('data-src');
        if (!src) continue;
        try {
          const controller = new AbortController();
          const id = setTimeout(() => controller.abort(), timeoutMs);
          const res = await fetch(src, { method: 'GET', signal: controller.signal, cache: 'no-store' });
          clearTimeout(id);
          if (!res.ok) {
            console.warn('[LottieChecker] Bad response for', src, res.status);
            replaceWithFallback(p, src);
          } else {
            // Optionally: quick validation length
            const txt = await res.text();
            if (!txt || txt.length < 40) replaceWithFallback(p, src);
          }
        } catch (err) {
          console.warn('[LottieChecker] Error loading', src, err && err.message ? err.message : err);
          replaceWithFallback(p, src);
        }
      }
    }

    function replaceWithFallback(playerEl, originalSrc) {
      if (playerEl.dataset.fallbackApplied) return;
      playerEl.dataset.fallbackApplied = '1';
      const fallbackImg = document.createElement('img');
      fallbackImg.alt = 'Animation unavailable';
      fallbackImg.loading = 'lazy';
      fallbackImg.src = 'https://via.placeholder.com/1200x600?text=Animation+Unavailable';
      fallbackImg.style.width = playerEl.style.width || '100%';
      fallbackImg.style.height = playerEl.style.height || 'auto';
      fallbackImg.style.objectFit = 'cover';
      const note = document.createElement('small');
      note.textContent = 'Animasi tidak tersedia — menggunakan fallback.';
      note.style.display = 'block';
      note.style.textAlign = 'center';
      note.style.marginTop = '6px';
      note.style.color = '#ddd';
      const wrapper = document.createElement('div');
      wrapper.className = 'lottie-fallback';
      wrapper.appendChild(fallbackImg);
      wrapper.appendChild(note);
      playerEl.replaceWith(wrapper);
      console.error('[LottieChecker] Replaced broken Lottie src:', originalSrc);
    }

    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', () => checkLottiePlayers());
    } else {
      checkLottiePlayers();
    }
    </script>

    <!-- App (user's JS) -->
    <script type="module" src="app.js"></script>
</body>
</html>
